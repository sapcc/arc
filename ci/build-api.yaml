---
platform: linux

image_resource:
  type: docker-image
  source: { repository: hub.***REMOVED***/monsoon/gobuild, tag: '1.7'}

inputs:
- name: arc.git
  path: gopath/src/gitHub.***REMOVED***/monsoon/arc
- name: arc.version

outputs:
- name: build

run:
  path: sh
  args:
    - -exc
    - |
      GOPATH=$PWD/gopath
      VERSION=$(cat arc.version/current)
      make -C gopath/src/gitHub.***REMOVED***/monsoon/arc bin/api-server bin/gencert BUILD_VERSION=$VERSION
      cp -r gopath/src/gitHub.***REMOVED***/monsoon/arc/ build/
