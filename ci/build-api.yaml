---
platform: linux

image_resource:
  type: docker-image
  source: { repository: hub.***REMOVED***/monsoon/gobuild, tag: '1.10-alpine'}

inputs:
- name: arc.git
  path: gopath/src/gitHub.***REMOVED***/monsoon/arc
- name: api.version

outputs:
- name: api-binary

run:
  path: sh
  args:
    - -exc
    - |
      export GOPATH=$PWD/gopath
      export BUILD_VERSION=$(cat api.version/current)
      make -C gopath/src/gitHub.***REMOVED***/monsoon/arc/api-server build
      cp gopath/src/gitHub.***REMOVED***/monsoon/arc/api-server/bin/* api-binary/
