package test

import (
	"time"
	// "fmt"
	// "github.com/lib/pq"
	"gitHub.***REMOVED***/monsoon/arc/api-server/models"
	// "gitHub.***REMOVED***/monsoon/arc/arc"
	ownDb "gitHub.***REMOVED***/monsoon/arc/api-server/db"
)

func main() {
	db, _ := ownDb.NewConnection("db/dbconf.yml", "test-local")
	
	// job := models.Job{}
	// job.Sender = "windows"
	// job.Version = 1
	// job.Agent = "execute"
	// job.Action = "script"
	// job.To = "darwin"
	// job.Timeout = 60
	// job.Payload = "echo \"Scritp start\"\n\nfor i in {1..10}\ndo\n\techo $i\n  sleep 1s\ndone\n\necho \"Scritp done\""
	// job.RequestID = "test_1"
	// job.Status = arc.Executing
	// job.CreatedAt = time.Now()
	// job.UpdatedAt = time.Now()
	// job.Save(db)
	
	// logPart := models.LogPart{"test_1", 1, "miau", false, time.Now()}
	// err = logPart.Save(db)
	// if err != nil {
	// 	fmt.Println(err.Error())
	// }
	//
	// if pg_err, ok := err.(*pq.Error); ok {
	// 	fmt.Println(pg_err.Code)
	// }

	lock := models.Lock{}
	lock.Example()
	lock.CreatedAt = time.Now().Add(-360*time.Second) // 6 min
	lock.Save(db)
	
	// save a lock just now
	lock2 := models.Lock{}
	lock2.Example()
	lock2.Save(db)

}